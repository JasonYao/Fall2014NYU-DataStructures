import java.io.File;
import java.io.FileNotFoundException;
import java.util.Scanner;

/**
 * This class is responsible for all input and output operations, including input validation
 * @author Jason
 */
public class ConsoleCalculator
{
	/**
	 * Main method that takes in a file input and a file output argument, with the file input
	 * containing line-delinated mathematical expressions. The output file will contain
	 * line-delinated mathematical answers to those expressions, unless the expression is
	 * invalid, in which case it will have INVALID for that line.
	 * @param args The path to the input file, then a space, and then the path to the output file
	 * @throws FileNotFoundException The file could not be found, or is a directory
	 * @throws InvalidCommandLineArgumentException There was an issue with the command line arguments
	 * @throws SecurityException The file could not be read from, or written to
	 */
	public static void main(String[] args) throws FileNotFoundException, 
	InvalidCommandLineArgumentException, SecurityException
	{
		Scanner inputScanner = null;
		try
		{
			// ---------- START OF FILE INPUT/OUTPUT PARSING ----------
			// Check 1: Checks to see if there is only 2 arguments			
			if (args.length != 2)
			{throw new InvalidCommandLineArgumentException();}

			// Check 2: Checks to see if the file output exists
			File expressionEvaluationOutput = new File(args[1]); 
			if (!expressionEvaluationOutput.isFile())
			{throw new FileNotFoundException("Error: The output file is missing or is a directory");}

			// Check 2.5: Checks to see if the file input exists
			File expressionEvaluationInput = new File(args[0]); 
			if (!expressionEvaluationInput.isFile())
			{throw new FileNotFoundException("Error: The input file is missing or is a directory");}

			// Check 3: Checks to see if the input file's permissions allow for reading
			SecurityManager inputSecurity = System.getSecurityManager();
			if (inputSecurity!= null) {
				inputSecurity.checkRead(args[0]); // Throws SecurityException
			}

			// Check 3.5: Checks to see if the output file's permissions allows for writing
			SecurityManager outputSecurity = System.getSecurityManager();
			if (outputSecurity!= null) {
				outputSecurity.checkWrite(args[1]); // Throws SecurityException
			}
			// ---------- END OF FILE INPUT/OUTPUT PARSING ----------

			// ---------- START OF INPUT FILE VALIDATION ----------
			inputScanner = new Scanner(expressionEvaluationInput);
			
			// Goes through the file, validating each line of the file
			while (inputScanner.hasNextLine())
			{
				// Validation of the line
				
			}



			// ---------- END OF INPUT FILE VALIDATION ----------

		} // End of try block
		catch (InvalidCommandLineArgumentException e)
		{System.err.println("Error: invalid command line arguments - please have one input and one output file path argument");}
		catch (FileNotFoundException e)
		{System.err.println(e.getMessage());}
		catch (SecurityException e)
		{System.err.println("Error: The file permissions do not allow the file to be read from or written to");}
		
		finally
		{
			// Checks to see if the scanner needs to be closed
			if (inputScanner != null)
			{
				inputScanner.close();
			}
		} // End of the finally block
	} // End of the main method
} // End of the Calculator class
